images:
- name: ghcr.io/lsst-dm/consdb-efdtransform
  newTag: "tickets-DM-43722"

namespace: dev-lsstcomcam

patches:
- patch: |-
    - op: replace
      path: /metadata/name
      value: dev-lsstcomcam
  target:
    kind: Namespace
  options:
    allowNameChange: true

secretGenerator:
  - name: postgres
    files:
    - butler-password=etc/.secrets/butler-password
    - consdb-url=etc/.secrets/db-uri
  - name: s3
    files:
    - access-key-id=etc/.secrets/access-key-id
    - secret-access-key=etc/.secrets/secret-access-key
    - s3-profile-embargo=etc/.secrets/s3-profile-embargo
  - name: usdf-efd
    files:
    - usdf-efd-password=etc/.secrets/usdf-efd-password
  - name: efd-transform-db
    files:
    - consdb-url=etc/.secrets/consdb-url

resources:
- ../../common
# Periodic cronjob
- cronjob-lsstcomcam.yaml

# Reprocess job with embargo old (adjust the start and end dates in the manifest)
# - reprocess-lsstcomcam-embargo-old.yaml

# Reprocess job with embargo new (adjust the start and end dates in the manifest)
# - reprocess-lsstcomcam-embargo-new.yaml

# Resume failed processing job with embargo old
- resume-lsstcomcam-embargo-old.yaml

# Resume failed processing job with embargo new
- resume-lsstcomcam-embargo-new.yaml
